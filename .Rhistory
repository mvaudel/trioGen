geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
i <- i + 1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
i <- i + 1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
i <- i + 1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
colors <- c("black", scico(n = 4, palette = "batlow", end = 0.8), scico(n = 3, palette = "hawaii", end = 0.8), scico(n = 2, palette = "cork"))
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
i <- i + 1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
i <- i + 1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
colors <- c("black", scico(n = 4, palette = "batlow", end = 0.8), scico(n = 3, palette = "hawaii", end = 0.8), scico(n = 2, palette = "cork", begin = 0.25, end = 0.75))
i <- i-1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
i <- i + 1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
colors <- c("black", scico(n = 4, palette = "batlow", end = 0.8), scico(n = 3, palette = "hawaii", end = 0.8), scico(n = 2, palette = "cork", begin = 0.2, end = 0.8))
i <- i-1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
i <- i + 1
ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
pColumns <- c("cmf_h_p", "h_B1_p", "h_B2_p", "h_B3_p", "h_B4_p", "cmf_Bc_p", "cmf_Bm_p", "cmf_Bf_p", "cmf_mt_Bmt_p", "cmf_ft_Bft_p")
colors <- c("black", scico(n = 4, palette = "batlow", end = 0.8), scico(n = 3, palette = "hawaii", end = 0.8), scico(n = 2, palette = "cork", begin = 0.2, end = 0.8))
labels <- c("cmf vs. h\nF-test p-value [-log10]", "h\nβ1 p-value [-log10]", "h\nβ2 p-value [-log10]", "h\nβ3 p-value [-log10]", "h\nβ4 p-value [-log10]", "cmf\nβc p-value [-log10]", "cmf\nβm p-value [-log10]", "cmf\nβf p-value [-log10]", "cmf_mt\nβmt p-value [-log10]", "cmf_fr\nβft p-value [-log10]")
theme_set(theme_bw(base_size = 24))
png(paste0("docs/lm_test/test.png"), width = 900, height = 600)
plot(pValuePlot)
dummy <- dev.off()
dummy <- dev.off()
dummy <- dev.off()
source('C:/Github/trioGen/src/R/testLM_chr7.R', encoding = 'UTF-8')
pValuePlot <- ggplot(
data = plotDF
) +
geom_point(
mapping = aes(
x = pos,
y = logValues
),
col = colors[i],
size = 2
) +
scale_y_continuous(
name = axisLabel,
limits = c(0, yMax),
expand = expand_scale(
mult = c(0, 0.05)
)
) +
scale_x_continuous(
name = "Chromosome 7",
expand = expand_scale(
mult = 0.02
)
) +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank()
)
source('C:/Github/trioGen/src/R/testLM_chr7.R', encoding = 'UTF-8')
source('C:/Github/trioGen/src/R/testLM_chr7.R', encoding = 'UTF-8')
source('C:/Github/trioGen/src/R/testLM_chr7.R', encoding = 'UTF-8')
getwd()
timePoints <- c("Birth", "6 w", "3 m", "6 m", "8 m", "1 y", "1.5 y", "2 y", "3 y", "5 y", "7 y", "8 y")
docFile <- "docs/lm_test/chr7.md"
write(x = "# Chromosome 7 - z_BMI\n\n", file = docFile, append = F)
write(x = "Chromosome 7 run with TrioGen v.0.3.0-beta on 27,451 full trios, ADHD cases, related, and ethnic outliers excluded. 10 PCs and genotyping batch as covariates. Reference panel AF > 5%, info score >= 0.7, singularities excluded\n", file = docFile, append = T)
write(x = "z_BMI “à la Chris”, see details [here](../pheno/plots.md):\n", file = docFile, append = T)
write(x = "- not the same as the pheno tables used so far!\n", file = docFile, append = T)
write(x = "- adjusted for pregnancy duration!\n\n", file = docFile, append = T)
write(x = "4 Models:\n", file = docFile, append = T)
write(x = "-h: `y = β1 h1 + β2 h2 + β3 h3 + β4 h4  + ε`\n", file = docFile, append = T)
write(x = "-cmf: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + ε`\n", file = docFile, append = T)
write(x = "-cmf_mt: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + βmt h1 + ε`\n", file = docFile, append = T)
write(x = "-cmf_ft: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + βft h1 + ε`\n", file = docFile, append = T)
write(x = "<br>", file = docFile, append = T)
for (ageI in 0:11) {
age = timePoints[ageI + 1]
pheno <- paste0("z_bmi", ageI)
write(x = paste0("### ", age, " - h vs. cmf (F-test p-value)\n\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_h_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_h_p_QQ.png)\n"), file = docFile, append = T)
write(x = paste0("### ", age, " - h betas (Prob(|t| > 0))\n\n"), file = docFile, append = T)
for (betaI in 1:4) {
write(x = paste0("- B", betaI, "\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_h_B", betaI, "_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_h_B", betaI, "_p_QQ.png)\n"), file = docFile, append = T)
}
write(x = paste0("### ", age, " - cmf betas (Prob(|t| > 0))\n\n"), file = docFile, append = T)
for (betaI in c("c", "m", "f")) {
write(x = paste0("- B", betaI, "\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_B", betaI, "_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_B", betaI, "_p_QQ.png)\n"), file = docFile, append = T)
}
write(x = paste0("### ", age, " - cmf_mt and cmf_ft (Prob(|t| > 0))\n\n"), file = docFile, append = T)
write(x = paste0("- Bmt\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_mt_Bmt_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_mt_Bmt_p_QQ.png)\n"), file = docFile, append = T)
write(x = paste0("- Bft\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_ft_Bft_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_ft_Bft_p_QQ.png)\n"), file = docFile, append = T)
write(x = "<br>", file = docFile, append = T)
}
docFile <- "docs/lm_test/chr7.md"
write(x = "# Chromosome 7 - z_BMI\n\n", file = docFile, append = F)
write(x = "Chromosome 7 run with TrioGen v.0.3.0-beta on 27,451 full trios, ADHD cases, related, and ethnic outliers excluded. 10 PCs and genotyping batch as covariates. Reference panel AF > 5%, info score >= 0.7, singularities excluded\n", file = docFile, append = T)
write(x = "z_BMI “à la Chris”, see details [here](../pheno/plots.md):\n", file = docFile, append = T)
write(x = "- not the same as the pheno tables used so far!\n", file = docFile, append = T)
write(x = "- adjusted for pregnancy duration!\n\n", file = docFile, append = T)
write(x = "4 Models:\n", file = docFile, append = T)
write(x = "-h: `y = β1 h1 + β2 h2 + β3 h3 + β4 h4  + ε`\n", file = docFile, append = T)
write(x = "-cmf: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + ε`\n", file = docFile, append = T)
write(x = "-cmf_mt: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + βmt h1 + ε`\n", file = docFile, append = T)
write(x = "-cmf_ft: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + βft h1 + ε`\n", file = docFile, append = T)
write(x = "<br>", file = docFile, append = T)
for (ageI in 0:11) {
age = timePoints[ageI + 1]
pheno <- paste0("z_bmi", ageI)
write(x = paste0("\n### ", age, " - h vs. cmf (F-test p-value)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_h_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_h_p_QQ.png)\n"), file = docFile, append = T)
write(x = paste0("### ", age, " - h betas (Prob(|t| > 0))\n\n"), file = docFile, append = T)
for (betaI in 1:4) {
write(x = paste0("- B", betaI, "\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_h_B", betaI, "_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_h_B", betaI, "_p_QQ.png)\n"), file = docFile, append = T)
}
write(x = paste0("\n### ", age, " - cmf betas (Prob(|t| > 0))\n"), file = docFile, append = T)
for (betaI in c("c", "m", "f")) {
write(x = paste0("- B", betaI, "\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_B", betaI, "_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_B", betaI, "_p_QQ.png)\n"), file = docFile, append = T)
}
write(x = paste0("\n### ", age, " - cmf_mt and cmf_ft (Prob(|t| > 0))\n"), file = docFile, append = T)
write(x = paste0("- Bmt\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_mt_Bmt_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_mt_Bmt_p_QQ.png)\n"), file = docFile, append = T)
write(x = paste0("- Bft\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_ft_Bft_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_ft_Bft_p_QQ.png)\n"), file = docFile, append = T)
write(x = "<br>", file = docFile, append = T)
}
docFile <- "docs/lm_test/chr7.md"
write(x = "# Chromosome 7 - z_BMI\n\n", file = docFile, append = F)
write(x = "Chromosome 7 run with TrioGen v.0.3.0-beta on 27,451 full trios, ADHD cases, related, and ethnic outliers excluded. 10 PCs and genotyping batch as covariates. Reference panel AF > 5%, info score >= 0.7, singularities excluded\n", file = docFile, append = T)
write(x = "z_BMI “à la Chris”, see details [here](../pheno/plots.md):\n", file = docFile, append = T)
write(x = "- not the same as the pheno tables used so far!\n", file = docFile, append = T)
write(x = "- adjusted for pregnancy duration!\n\n", file = docFile, append = T)
write(x = "4 Models:\n", file = docFile, append = T)
write(x = "-h: `y = β1 h1 + β2 h2 + β3 h3 + β4 h4  + ε`\n", file = docFile, append = T)
write(x = "-cmf: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + ε`\n", file = docFile, append = T)
write(x = "-cmf_mt: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + βmt h1 + ε`\n", file = docFile, append = T)
write(x = "-cmf_ft: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + βft h1 + ε`\n", file = docFile, append = T)
for (ageI in 0:11) {
age = timePoints[ageI + 1]
pheno <- paste0("z_bmi", ageI)
write(x = paste0("\n### ", age, " - h vs. cmf (F-test p-value)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_h_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_h_p_QQ.png)\n"), file = docFile, append = T)
write(x = paste0("\n### ", age, " - h betas (Prob(|t| > 0))\n"), file = docFile, append = T)
for (betaI in 1:4) {
write(x = paste0("- B", betaI, "\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_h_B", betaI, "_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_h_B", betaI, "_p_QQ.png)\n"), file = docFile, append = T)
}
write(x = paste0("\n### ", age, " - cmf betas (Prob(|t| > 0))\n"), file = docFile, append = T)
for (betaI in c("c", "m", "f")) {
write(x = paste0("- B", betaI, "\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_B", betaI, "_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_B", betaI, "_p_QQ.png)\n"), file = docFile, append = T)
}
write(x = paste0("\n### ", age, " - cmf_mt and cmf_ft (Prob(|t| > 0))\n"), file = docFile, append = T)
write(x = paste0("- Bmt\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_mt_Bmt_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_mt_Bmt_p_QQ.png)\n"), file = docFile, append = T)
write(x = paste0("- Bft\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_ft_Bft_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_ft_Bft_p_QQ.png)\n"), file = docFile, append = T)
}
docFile <- "docs/lm_test/chr7.md"
write(x = "# Chromosome 7 - z_BMI\n\n", file = docFile, append = F)
write(x = "Chromosome 7 run with TrioGen v.0.3.0-beta on 27,451 full trios, ADHD cases, related, and ethnic outliers excluded. 10 PCs and genotyping batch as covariates. Reference panel AF > 5%, info score >= 0.7, singularities excluded\n", file = docFile, append = T)
write(x = "z_BMI “à la Chris”, see details [here](../pheno/plots.md):\n", file = docFile, append = T)
write(x = "- not the same as the pheno tables used so far!\n", file = docFile, append = T)
write(x = "- adjusted for pregnancy duration!\n\n", file = docFile, append = T)
write(x = "4 Models:\n", file = docFile, append = T)
write(x = "- h: `y = β1 h1 + β2 h2 + β3 h3 + β4 h4  + ε`\n", file = docFile, append = T)
write(x = "- cmf: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + ε`\n", file = docFile, append = T)
write(x = "- cmf_mt: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + βmt h1 + ε`\n", file = docFile, append = T)
write(x = "- cmf_ft: `y = βm (h1 + h2) + βc (h1 + h3) + βf (h3 + h4) + βft h1 + ε`\n", file = docFile, append = T)
for (ageI in 0:11) {
age = timePoints[ageI + 1]
pheno <- paste0("z_bmi", ageI)
write(x = paste0("\n### ", age, " - h vs. cmf (F-test p-value)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_h_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_h_p_QQ.png)\n"), file = docFile, append = T)
write(x = paste0("\n### ", age, " - h betas (Prob(|t| > 0))\n"), file = docFile, append = T)
for (betaI in 1:4) {
write(x = paste0("- B", betaI, "\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_h_B", betaI, "_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_h_B", betaI, "_p_QQ.png)\n"), file = docFile, append = T)
}
write(x = paste0("\n### ", age, " - cmf betas (Prob(|t| > 0))\n"), file = docFile, append = T)
for (betaI in c("c", "m", "f")) {
write(x = paste0("- B", betaI, "\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_B", betaI, "_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_B", betaI, "_p_QQ.png)\n"), file = docFile, append = T)
}
write(x = paste0("\n### ", age, " - cmf_mt and cmf_ft (Prob(|t| > 0))\n"), file = docFile, append = T)
write(x = paste0("- Bmt\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_mt_Bmt_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_mt_Bmt_p_QQ.png)\n"), file = docFile, append = T)
write(x = paste0("- Bft\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_ft_Bft_p_MH.png)\n"), file = docFile, append = T)
write(x = paste0("![](", pheno, "_cmf_ft_Bft_p_QQ.png)\n"), file = docFile, append = T)
}
